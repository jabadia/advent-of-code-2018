from collections import namedtuple

TestCase = namedtuple('TestCase', 'case expected')

INPUT = r"""                    /-----------------------------------------------------------------------------------------------------\                           
                    |/---------------------\                                                                              |                           
                    ||                   /-+-----------------------------------------------\     /----------------------\ |            /-------------\
                    ||                   | |                    /--------------------------+-----+-----------------\    | |            |             |
                    ||            /------+-+--------------------+--------------------------+-----+-----------------+----+-+------------+---\         |
                    ||           /+------+-+--------------------+--------------------------+-----+-----------------+----+-+---\        |   |         |
                    ||          /++------+-+--------------------+--------------------------+-----+-----------------+----+-+--\|        |   |         |
                   /++----------+++------+-+--------------------+-------\                  |     |                 ^    | |  ||        |   |         |
                   |||          |||      |/+--------\           |  /----+----------------\ |     |                 |    | |  ||        |   |         |
            /------+++----------+++------+++--------+-----------+--+----+----------------+-+-----+----\            |   /+-+--++--\     |   |         |
            |      |||          |||      |||   /----+-----------+--+----+----------------+-+-----+----+------------+---++-+--++--+--\  |   |         |
            |      |||          |||      |||/--+----+-----------+--+----+----------------+-+-----+----+------------+---++-+--++--+--+\ |   |         |
            |      |||        /-+++------++++--+----+-----------+--+----+-------------\  | |     |    |            |/--++-+--++--+--++\\---+---------/
            |      |||        | |||      ||v|  |    |           |  |    |             |  | |     |    |          /-++--++-+--++--+--+++---\|          
            |      |||        | |||      ||||  |   /+-----------+--+----+-------------+--+-+-----+----+----------+-++-\|| |  ||  |  |||   ||          
            |      |||        | |||      ||||  |   ||           |  |    |             |  | |     |    |          | || ||| |  ||  |  |||   ||          
            |      |||        | |||      ||||/-+---++---\   /---+--+----+-------------+--+-+-----+----+------\   | || ||| |  ||  |  |||   ||          
            |      |||        | |||      ||||| |   ||   |   |   |  |    |             |  | |     |    |      |  /+-++-+++-+--++--+--+++--\||          
  /---------+------+++--------+-+++------+++++-+---++---+---+---+--+----+-------------+\ | |     |    |      |  || || ||| |  ||  |  |||  |||          
  |         |      |||/-------+-+++------+++++-+---++---+---+---+--+----+-------------++-+-+-----+----+------+--++-++\||| |  ||  |  |||  |||          
  |         |      |||^       | ||\------+++++-+---++---+---+---+--+----+-------------++-+-+-----+----+------+--++-++++++-+--++--+--+++--++/          
  |         |      |||| /-----+-++----->-+++++-+---++---+---+---+--+----+----------\  || | |     |    |   /--+--++-++++++-+--++--+--+++--++----------\
  | /-------+------++++-+-----+-++-------+++++-+---++---+-\ |   |  |    |          |  || | |/----+----+---+--+--++-++++++-+--++--+-\|||  ||          |
  | |       |      |||| |     | ||   /---+++++-+---++---+-+-+---+--+----+----------+--++-+-++----+----+-\ |  |  || |||||| |  ||  | ||||  ||          |
  | |       |      |||| |     | ||   |   ||||| |   ||   | | |   |  |    |          |  || | ||   /+----+-+-+--+--++-++++++-+--++--+-++++--++-\        |
/-+-+-------+------++++-+-----+-++---+---+++++-+---++---+-+-+---+--+----+----------+--++-+\||   ||    | | |  |  || |||||| |  ||  | ||||  || |        |
| | |       |      |||| |     | || /-+---+++++-+---++---+-+\|   |  |    |          |  || ||||   ||    | | |  |  || |||||| |  ||  | ||||  || |        |
| | |       |      |||| |     | || | |   ||||| |   ||   | ||| /-+--+----+----------+--++-++++---++----+-+-+--+--++-++++++-+--++--+-++++--++-+------\ |
| | |       |      |||| |     | || | |   \++++-+---++---+-+++-+-+--+----+----------+--++-++/|   |\----+-+-+--+--++-+++++/ |  ||  | ||||  || |      | |
| | |       |      ||||/+-----+-++-+-+----++++-+---++---+-+++-+-+--+----+----------+--++-++-+---+-----+-+-+--+--++-+++++-\|  ||  | ||||  || |      | |
| | |       |      ||||||     | || | |    |||| |   ||   | ||| | |  |    |          |  || || |   |     | | |  |  || |\+++-++--++--+-+++/  || |      | |
| | |       |      ||||||     | || | |    |||| |   ||   | ||| | \--+----+----------+--++-++-+---+-----+-+-+--+--++-/ ||| ||  ||  | |||   || |      | |
| | |       |      ||||||     \-++>+-+----++++-+---++---+-+++-+----+----+----------+--/| || |   |     | | |  |  ||   ||| ||  ||  | |||   || |      | |
| | |       |      ||||||       || | |    |||| |   ||   | ||| |    | /--+----------+---+-++-+---+-----+-+-+--+--++---+++-++--++--+-+++\  || |      | |
| | |  /----+------++++++-------++-+-+----++++-+---++-\ | ||| |    | |  | /--------+---+-++-+---+-----+-+-+--+--++-\ ||\-++--++--/ ||||  || |      | |
| | |  |    |   /--++++++-------++-+-+----++++\|   || | | ||| |    | |  | |        |   | || |   |     | | |  |  || | ||  ||  ||    ||||  || |      | |
| | |  |    |   |  ||||||       || | |    ||||||   || | | ||| |    | |  | |        |   | || |   |     | | |  |  || | ||  ||  ||    ||||  || |      | |
| | |  |    |   |  ||||||/------++-+-+----++++++---++-+-+-+++-+----+-+--+-+--------+---+-++-+---+-\   | | |  |  || | ||  ||  ||    ||||  || |      | |
| | |  |   /+---+--+++++++---\  || | | /--++++++---++-+-+\||| |    \-+--+-+--------+---+-/| |   | |   | | |  |  || | ||  ||  ||    ||||  || |      | |
| |/+--+---++---+\ |||||||   | /++-+-+-+--++++++---++-+-+++++-+------+--+-+--------+---+--+-+---+-+---+-+-+--+--++-+-++--++--++--\ ||||  || |      | |
| |||  |   ||   || |||||||   | ||| | | |/-++++++---++-+-+++++-+------+--+-+--------+---+--+-+---+-+---+-+-+--+\ || | ||  ||  ||  | ||||  || |      | |
| |||  |  /++---++-+++++++\  | ||| | | || ||||||   || | ||||| |      |  | |        |   |  | |   | |   | | |  || || | ||/-++--++--+\||||  || |      | |
| |||  |  |||   || ||||||||  | ||| | | || ||||||   || | ||||| |      |  | |        |   |  | |   | |   | | |  || || | ||| ||  ||  ||||||  || |      | |
| |||  |  |||   || ||||||||  | ||| | | || ||||||   || | ||||| |/-----+--+-+-----\  |   |  | |   | |   | | |  || || | |||/++--++--++++++--++-+\     | |
| |||  |  ||| /-++-++++++++--+-+++-+-+-++-++++++---++-+\||||| \+-----+--+-+-----+--+---+->+-+---+-+---+-+-+--++-++-+-++++++--++--++++++--++-++-----/ |
| |||  |  ||| | || ||||||||  | ||| | | || ||||||   || |||||||  |    /+--+-+-----+--+---+--+-+---+-+\  | |/+--++-++-+-++++++--++--++++++\ || ||       |
| |||  |  ||| | || ||||||||  | |\+-+-+-++-++++++---++-+++++++--+----++--+-+-----+--+---+--+-+---+-++--+-+++--++-++-+-++++++--/|  ||||||| || ||       |
| |||  |  ||| | || ||||||||  | | \-+-+-++-++++++---++-+++++++--+----++--+-+-----+--+---+--+-+---+-++--+-+++--++-++-+-++++++---/  ||||||| || ||       |
| |||  |  ||| | || ||||||||  | |   | | \+-++++++---++-+++/|||  |    ||  | |     |  |   |  | |/--+-++--+-+++--++-++-+-++++++------+++++++\|| ||       |
| |||  |  ||| | || ||||||||  | \---+-+--+-++++++---++-+++-+++--+----++--+-+-----+--+---+--+-++--+-++--+-+++--++-++-+-++++++------/||||||||| ||       |
| ||\--+--+++-+-++-++++++++--+-----+-+--+-++++++---++-+++-/||  |    ||  |/+-----+--+---+\ | ||  | ||  | |||  || || | ||||||       ||||||||| ||       |
| ||   |  ||| | || ||||||||  |     | |  | \+++++---+/ |||  ||  |    |\--+++-----+--+---++-+-++--+-++--+-+++--++-++-+-++++++-------++++/|||| ||       |
| ||   |  ||| | || ||||||||  |     | |/-+--+++++\  |  |||  ||  |    |   |||     |  |   || | ||  | ||  | |||  || || | ||||||       |||| |||| ||       |
| ||   |  ||| | || \+++++++--+-----+-++-+--++++++--+--+++--++--+----+---/||     |  |   || | ||/-+-++--+-+++--++-++-+-++++++-------++++-++++-++-----\ |
| ||   \--+++-+-++--+++++++--+-----+-++-+--++++++--+--/||  ||  |    |    ||     |  |   || | ||| | ||  | |||  || || | ||||||       |||| |||| ||     | |
| ||      ||| | ||  |||||||  |    /+-++-+--++++++--+---++--++--+----+----++-----+--+---++-+-+++-+-++--+-+++--++-++-+-++++++-------++++-++++-++\    | |
| ||      ||| | ^|  |||\+++--+----++-++-+--++++++--+---++--++--+----+----++-----+--+---++-+-+++-+-++--+-+++--++-++-+-++++/|       |||| |||| |||    | |
| ||   /--+++-+-++--+++-+++--+----++-++-+--++++++--+---++--++--+----+----++-----+--+---++-+\||| | ||  | |||  || || | |||| |       |||| |||| |||    | |
| ||   |  \++-+-++--+++-++/  |    ||/++-+--++++++--+---++--++--+----+----++-\ /-+--+---++-+++++-+-++--+-+++--++-++-+-++++-+-------++++-++++-+++---\| |
| ||  /+---++-+-++--+++-++---+----+++++-+--++++++--+---++--++--+---\|    ||/+-+-+--+---++-+++++-+-++--+-+++--++-++-+-++++-+\      |||| |||| |||   || |
| ||  ||   || | ||  ||| ||   |/---+++++-+--++++++--+-\ ||  ||  |   ||    |||| | |  |   || ||||| | ||  | |||  || || | |||| ||      |||| |||| |||   || |
| ||  ||   || | ||  ||| ||   ||   ||||| |  ||||||  | | ||  ||  |   ||    |||| | |  |   || ||||| | ||  | |||  || \+-+-++++-++------++++-++/| |||   || |
| ||  ||   || | ||  \++-++---++---+++++-+--++++++--+-+-++--++--+---++----++++-+-+--+---++-+++++-+-++--+-+++--++--+-+-++++-/|      |||| || | |||   || |
| ||  || /-++-+-++---++-++---++---+++++-+--++++++--+-+-++->++--+---++----++++-+-+--+---++-+++++-+-++--+-+++--++\ | | ||||  |      |||| || | |||   || |
| ||  || | || | ||   || ||   ||   ||||| |  ||||||/-+-+-++--++\ |  /++----++++-+-+--+---++-+++++-+-++--+-+++--+++-+-+-++++--+---\  |||| || | |||   || |
| ||  || | || | ||   || ||   ||   ||||| |  ||||||| | | ||  ||| |  |||    |||| | |  |   || ||||| | ||  | |||  ||| | | ||||  |   |  |||| || | |||   || |
|/++--++-+-++-+-++---++-++---++-\ ||||| |  ||||||| | | ||  ||| |  |||    |||| | |  |   || ||||| | ||  | |||  ||| | | ||||  |   |  |||| || | |||   || |
||||  || | || | ||   || ||   || | ||||| |/-+++++++-+-+-++--+++-+--+++----++++-+-+--+---++-+++++-+-++--+-+++--+++-+-+-++++--+---+--++++-++-+-+++--\|| |
||||  || | || | ||   || ||   || | ||||| || ||||||| | |/++--+++-+--+++----++++\| |  |   || ||||| | ||  | |||  ||| | | ||||  |   |  |||| || | |||  ||| |
||||  || | || | ||   || ||   || | ||\++-++-+++++++-+-++++--+++-+--+++----+++/|| |  |   || ||||| | ||  | |||  ||| | | ||||  |   |  |||| || | |||  ||| |
||||  || | || | ||   || ||   || | || || || ||||||| | ||||  ||| |  |||    \++-++-+--+---+/ ||||| | ||  | |||  ||| | | ||||  |   |  |||| || | |||  ||| |
||||  || | || | ||   || ||   || | || || || ||||||| | ||||  ||| |  |||     || || |  |   |  ||||| | ||/-+-+++--+++-+-+-++++--+---+--++++-++\| |||  ||| |
||||  || | || | ||   || ||   ||/+-++-++-++-+++++++\| ||||  ||| |  |||     || || |  |   |  ||||| | ||| | |||  ||| | | ||||  |   |  |||| |||| |||  ||| |
||||  || | |\-+-++---++-++---++++-++-++-++-+++++++++-++++--+++-+--+++-----++-++-+--+---+--+++++-+-+++-/ |||  ||| | | |||\--+---+--++++-++++-+/|  ||| |
||||  || |/+--+-++---++-++---++++-++-++-++-+++++++++-++++\ ||| |  |||     || || |  |   |  ||||| | |||   |||  ||| | | |||   |   |  |||| |||| | |  ||| |
||||  || |||  | ||   || ||   |||| || || || ||||||||| ||||| ||| \--+++-----++-++-/  |   |  ||||| | |||   |||  ||| | | |||   |   |  |||| |||| | |  ||| |
|\++--++-+++--+-++---++-++---+++/ || \+-++-+++++++++-+++++-+++----+++-----++-++----+---+--+++++-+-+++---/||  ||| | | |||   |   |  |||| |||| | |  ||| |
| ||/-++-+++--+-++---++-++---+++--++--+-++-+++++++++-+++++-+++----+++-----++-++----+---+--+++++\| |||    ||  ||| | | |||   |   |  |||| |||| | |  ||| |
| ||| || |||  | ||   || ||   |\+--++--+-++-+++++++++-/|||| |||    |||     || ||    |   |  ||||||| |||    ||  ||| | | |||   |   |  |||| |||| | |  ||| |
| ||| || |||  | ||   || ||   | | /++--+-++-+++++++++--++++-+++\   |||     || ||    |   |  ||||||| |||    ||  ||| | | |||   |   |  |||| |||| | |  ||| |
| v|| || |||  | ||   || ||   | | |||  | ||/+++++++++-\|||| ||||   |||     || ||    |  /+--+++++++-+++----++\ ||| | | |||   |   |  |||| |||| | |  ||| |
| ||| || |||  | ||   || ||   |/+-+++--+-++++++++++++-+++++-++++---+++--\  || ||  /-+--++--+++++++-+++-\  \++-+++-+-+-+++---+---+--++++-/||| | |  ||| |
| ||| || |||  | ||   || ||   ||| |||  | |||||||||||| ||||| ||||   |||  |  || ||  | |  ||  ||||||| ||| |   || ||| \-+-+++---+---+--++++--++/ | |  ||| |
| ||| || |||  | ||   || ||   ||| |||  | |||||||||||| ||||| ||||   |||  |  || ||  | |  ||  ||||||| ||| |   || |||   | |||   |   |  ||||  ||  | |  ||| |
| ||| || |||  | ||   || ||   ||| |||  | |||||\++++++-+++/| ||||   |||  |  || ||  | |  ||  ||||||| ||| |   \+-+++---+-+++---+---+--++++--++--+-+--+++-/
| ||| || |||  | ||   || ||   ||| |||  | ||||| |||||| ||| | ||||   |||  |  || ||  | |  ||  ||||||| ||| | /--+-+++---+\|||   |   |  ||||  ||  | |  |||  
| ||| || |||  | ||   || ||   ||| |||  | ||||| ||v||| ||| | ||||   \++--+--++-++--+-+--++--+++++++-+++-+-+--+-+++---+++++---+---/  ||||  ||  | |  |||  
| ||| || |||  | ||   || ||   ||| |||/-+-+++++>++++++-+++-+-++++----++--+--++-++--+-+--++--+++++++-+++-+-+--+-+++---+++++---+-\    ||||  ||  | |  |||  
| ||| || |||  | ||   \+-++---+++-++++-+-+++/| |||||| ||| | ||||  /-++--+->++-++--+-+--++--+++++++-+++-+-+--+-+++---+++++---+-+---\||||  ||  | |  |||  
| ||| || |||  | ||    \-++---+++-++++-+-+++-+-++++++-+++-+-++++--+-++--+--++-++--+-+--++--+++++++-+++-+-+--+-+++---++/||   | |   |||||  ||  | |  |||  
| ||| || |||  | ||      ||   ||| |||| | ||| | |||||| ||| | ||||  | ||  |  || ||  | |  ||  ||||||| ||| | |  | |||   || ||   | |   |||||  ||  | |  |||  
| \++-++-+++--+-++------++---+++-++++-+-+++-+-++++++-+++-+-++++--+-++--+--++-++--+-+--+/  ||||||| ||| | |  | |||   || ||   | |   |||||  ||  | |  |||  
|  |\-++-+++--+-++------++---+++-++++-+-+++-+-++++++-+++-+-++++--+-++--+--++-++--+-+--+---+++++/| ||| | |  | |||   || ||   | |   |||||  ||  | |  |||  
|  |  || |||  | ||   /--++---+++-++++-+-+++-+-++++++\||| | ||||  | ||  |  || ||  | |  |   ||||| |/+++-+-+--+-+++---++-++---+-+---+++++--++--+-+\ |||  
|  |  || |||  | ||   |  ||   ||| |||| | ||| | |||||\++++-+-++++--+-++--+--++-++--+-+--+---+++++-+++++-+-+--+-+++---++-/|   | |   |||||  ||  | || |||  
|  |  || |||  | \+---+--++---+++-++++-+-+++-+-/\+++-++++-+-++++--+-++--+--++-++--+-+--+---+++++-+++++-+-+--+-+++---++--+---+-+---+++/|  ||  | || |||  
|  |  || |||  |  |   |  ||   ||| \+++-+-+++-+---+++-++++-+-+++/  | ||  |  ||/++--+-+--+---+++++-+++++-+-+--+-+++---++--+---+-+--\||| |  ||  | || |||  
|  |  || |||  |  |   |  ||   |||  ||| | ||| |   ||| |||| | |\+---+-++--+--+++++--+-+--+---+++++-+++++-+-+--+-/||   ||  |  /+-+--++++-+--++--+\|| |||  
|  |  ||/+++--+--+---+--++---+++--+++-+-+++-+---+++-++++-+-+-+---+-++--+->+++++-\| |  |   ||||| \++++-+-+--+--++---++--+--++-+--++++-+--++--/||| |||  
|  |  ||||||  |  |   |  ||   |||  ||| | |\+-+---+++-++++-+-+-+---+-++--+--+++++-++-+--+---+++++--++++-+-+--+--++---++--+--++-+--++++-+--++---+++-/||  
|  |  ||||||  |  |   |  ||   |||  ||| | | | |   ||| |||| | | | /-+-++--+-\||||| || |  |   |||||  |||| | |/-+--++---++-\|  || |  |||| |  ||   |||  ||  
|  |  ||||||/-+--+---+--++---+++--+++-+-+-+-+---+++-++++-+-+-+-+-+-++--+-++++++-++-+--+---+++++--++++-+-++-+--++\  || ||  || |  |||| |/-++---+++\ ||  
|  |  ||||||| |  |   |  ||   |||  ||| | | |/+---+++-++++-+-+-+-+-+-++--+-++++++-++-+--+---+++++--++++-+-++-+--+++--++-++--++-+--++++-++-++-\ |||| ||  
|  |  ||||||| |  |  /+--++---+++--+++-+-+-+++---+++-++++-+-+-+-+\| ||  | |||||| || |  |   |||||  |||| | || |  |||  || ||  || |  |||| || || | |||| ||  
|  |  ||||||| |  |  ||  ||   |||  ||| | | |||   ||| |||| | | | ||| ||  | |||||| || |  |   |||||  |||\-+-++-+--+++--++-++--++-+--++++-++-+/ | |||| ||  
|  |  ||||||| |  |  ||  ||   |||  ||| | | |||   ||| |||| | | | ||| ||  | |||||| || |  |   |||||  |||  | || |  |||  || ||  || |  |||| || |  | |||| ||  
|  |  ||||||| |  |  ||  ||   |||  ||| | | ||| /-+++-++++-+-+-+-+++-++--+-++++++-++-+--+---+++++--+++--+-++-+--+++--++-++--++-+--++++-++-+--+-++++-++\ 
|  |  ||||||| |  |  ||  ||/--+++--+++-+-+-+++-+-+++-++++-+-+-+-+++-++--+-++++++-++-+--+---+++++--+++--+-++-+--+++--++-++--++-+-\|||| || |  | |||| ||| 
|  |  ||||||| |  |  ||  |||  |||  ||| | | ||\-+-+++-++++-+-+-+-+++-++--+-++++++-++-+--+---+++++--+++--+-++-+--+++--++-++--++-+-+++++-/| |  | |||| ||| 
|  |  ||\++++-+--+--++--+++--+++--+++-+-+-++--+-+++-++++-+-+-+-+++-++--+-++++++-/| |  |   |||||  |||  | || |  ||v  || ||  || | |||||  | |  | |||| ||| 
|  |  || |||| |  |  ||  |||  |||  ||| | \-++--+-+++-++++-+-+-+-+++-++--+-++++++--+-+--+---+++++--+++--+-++-+--/||  || ||  || | |||||  | |  | |||| ||| 
|  |  || |||| |  |  ||  |||  ||\--+++-+---++--+-++/ |||| | | | ||| ||  | ||||||  \-+--+---+++++--+++--/ || |   ||  || ||  || | |||||  \-+--+-+++/ ||| 
|  |  || |||| |  |  ||  \++--++---+++-+---++--+-++--++++-+-+-+-+++-++--+-++++++----/  |   |||||  |||    |\-+---++--++-/\--++-+-+++/|    |  | |||  ||| 
|  |  || |||| |  |  ||   ||  ||   ||| |   ||  | |\--++++-+-+-/ ||| ||  | |||\++-------+---+++++--+++----+--+---++--++-----++-+-+/| |    |  | |||  ||| 
|  |  || |||| |  |  ||   ||  ||   ||| |   ||  | |   |||| | |   ||| ||  | ||| ||       |   ||\++--+++----+--+---++--++-----++-+-+-+-/    |  | |||  ||| 
|  |  || \+++-+--+--++---++--++---+++-+---++--+-+---++++-+-+---+++-++--+-+++-++-------+---++-++--+++----+--+---/|  ||     || | | |      |  | |||  ||| 
| /+--++--+++-+--+--++---++--++---+++-+---++--+-+---++++-+-+---+++-++--+-+++-++-------+---++-++--+++----+--+-\  |  ||     || | | |      |  | |||  ||| 
| ||  ||  ||| |  |  ||   ||  ||   ||| |   ||  | |   ||\+-+-+---+++-++--+-+++-/|       \---++-++--+++----+--/ |  |  ||     \+-+-+-+------+--+-/||  ||| 
| ||  ||  ||| |  |  ||   ||  ||   ||| |   ||/-+-+---++-+-+-+---+++-++--+-+++--+-----------++-++--+++----+----+--+--++------+\| | |      |  |  ||  ||| 
| ||  ||  ||| |  |  ||   ||  ||   ||| |   ||| | |   || | | |   ||| ||  | |||  |           || ||  |||    |    |  |  ||      ||| | |      |  |  ||  ||| 
| ||  ||  ||| |  |  ||   ||  ||   |\+-+---+++-+-+---++-+-+-/   ||| ||  | |||  |           || ||  |||    |    |  |  ||      ||| | |      |  |  ||  ||| 
| ||  ||  ||| |  | /++---++-\||   | | |   ||| | |   || | |     ||| ||  | |\+--+-----------++-++--+++----+----+--+--/|      ||| | |      |  |  ||  ||| 
| ||  ||  ||| |  | |||   || |||   | | |   ||| | |   || | |     ||| |\--+-+-+--+-----------++-++--++/    |    |  |   |      ||| | |      |  |  ||  ||| 
| ||  ||  ||| |  | |||   || |||   | | |   ||| | |   || | |     ||| |   | | |  |           || \+--++-----+----+--+---+------+++-+-+------/  |  ||  ||^ 
| ||  ||  ||| |  | |||   || |||   | \-+---+++-+-+---++-+-+-----+++-+---+-+-+--+-----------++--+--++-----+----+--+---+------++/ | |         |  ||  ||| 
| ||  ||  ||| |  | ||\---++-+++---+---+---+++-+-+---/| | |     ||| |   | | |  \-----------++--+--++-----+----+--+---+------++--+-+---------+--++--/|| 
| ||  \+--+++-+--+-++----++-+++---+---+---+++-+-+----+-+-+-----+++-/   | | |              ||  \--++-----+----+--+---+------++--+-+---------+--++---/| 
| ||   |  ||| |  | ||    || |||   |   |   ||| | |    | | |     |||     | | |              ||     ||     |    |  |   |      ||  | |         |  ||    | 
\-++---+--+++-+--+-++----++-+++---+---+---+++-+-+----+-+-+-----+++-----+-+-+--------------/|     ||/----+----+--+---+------++--+-+-------\ |  ||    | 
  ||   |  ||| |  | ||    || |||   |   |   ||| | |    | | |     |||     | | |     /---------+-----+++----+----+--+---+------++--+-+-------+-+--++-\  | 
  ||   |  ||| |  | ||    |\-+++---+---+---+++-+-+----+-+-+-----+++-----+-+-+-----+---------+-----+++----+----+--+---+------++--/ |       | |  || |  | 
  ||   |  ||| |  | ||    \--+++---+---+---+++-+-+----+-+-+-----+++-----+-+-+-----+---------+-----+/|    |    |  |   |      ||    |       | |  || |  | 
  ||   \--+++-+--+-++-------+++---+---+---+++-+-+----+-+-+-----+++-----+-+-+-----+---------/     | |    |    |  |   |      ||    |       | |  || |  | 
  ||      ||| |  | \+-------/||   |   |   ||| | |    | | |     |||     | | \-----+---------------+-+----+----+--+---+------/|    |       | |  || |  | 
  ||      |\+-+--+--+--------/|   |   |   ||| | |    | | |   /-+++-----+-+-------+-----<---------+-+----+--\ |  |   |       |    |       | |  || |  | 
  ||      | | |  |  |         |   |   |   ||| \-+----+-+-+---+-+++-----+-+-------+---------------+-+----+--+-+>-+---+-------+----+-------+-+--++-+--/ 
  ||      | | |  |  |         \---+---+---+++---+----+-+-+---+-+++-----/ |       |               | |    |  | |  |   |       |    |       | |  || |    
  ||      | | |  |  |             |   |   ||\---+----+-+-+---+-+++-------+-------+---------------+-+----+--+-+--+---+-------/    |       | |  || |    
  ||      | | |  |  |             |   |   \+----+----/ | |   | |||      /+-------+--------\      | |    |  | |  |   |            |       | |  || |    
  ||      | | |  |  |             |   |    |    |      | |   | |||      ||       |        |      \-+----+--+-+--+---+------------+-------+-+--+/ |    
  ||      | \-+--+--+-------------+---+----+----+------+-+---+-+++------++-------+--------+--------+----+--+-+--/   |            |       | |  |  |    
  |\------+---+--/  |             |   |    |    |      | |   | ||\------++-------+--------+--------+----+--+-+------+------------/       | |  |  |    
  \-------+---+-----+-------------+---+----+----+------+-+---+-++-------++-------+--------+--------+----+--+-/      |                    | |  |  |    
          |   |     |             |   \----+----/      | |   | ||       ||       |        |        |    |  |        |                    | |  |  |    
          |   |     |             \--------+-----------+-+---+-++-------++-------+--------+--------+----+--+--------+--------------------+-+--/  |    
          |   \-----+----------------------+-----------/ |   \-++-------++-------+--------+--------+----+--/        |                    | |     |    
          |         \----------------------+-------------+-----+/       ||       \--------+--------+----+-----------+--------------------+-+-----/    
          |                                |             |     \--------+/                |        |    \-----------/                    | |          
          |                                \-------------+--------------+-----------------+--------+-------------------------------------+-/          
          \----------------------------------------------/              \-----------------/        \-------------------------------------/            
"""


def check_case(test_case, actual):
    if test_case.expected == actual:
        print("OK %s" % (test_case.case[:40] + '...',))
    else:
        print("FAIL %s, expected %s, got %s" % (test_case.case[:40] + '...', test_case.expected, actual))


TEST_CASES = [
    TestCase(r"""/->-\        
|   |  /----\
| /-+--+-\  |
| | |  | v  |
\-+-/  \-+--/
  \------/   
""", (3, 7)),
    TestCase(r"""                                         /---->--------------------------------------------------\                                                    
                                         |/------------------------>---------------------\       |                                                    
                                         ||                                              |       |              /-----------------------\/---------\  
                                         ||               /------------------------------+-------+--------------+-------------\         ||         |  
          /------------------------------++-------------\ |                           /--+-------+--------------+-------------+---------++--------\|  
    /-----+------------------------------++-------------+-+----------------------\    |  |       |         /----+------------\|         ||        ||  
    |/----+------------------------------++-------------+-+---\        /---------+----+--+-------+-----\   |    |            ||         ||        ||  
    ||    |                              ||             | |   |        |         |    |  |       |     |   |   /+--------\   ||         ||        ||  
    ||    |                              ||             | |   |/-------+---------+----+--+-------+-----+\  |   ||        |   ||         ||        ||  
    ||    |       /-----------\          ||  /----------+-+---++-----<-+---------+----+--+-------+-----++--+---++--------+---++---------++----\   ||  
    ||    |   /---+-----------+----------++--+----\     | |   ||       |         |    |  |       |     ||  |   ||        |   ||         ||    |   ||  
    ||    |   |   |           |         /++--+----+-----+-+---++-------+---------+----+--+\      |     ||  |   ||        |/--++--------\||    |   ||  
 /--++----+--\|   |           |         |||  |    |     | |   v|       |         |    |  ||      |     ||  |   ||        ||  ||        |||    |   ||  
 |  ||    |  ||   |           |         |||  |    |     |/+---++-------+---------+----+\ ||      |     ||  |   ||        ||  ||        |||    |   ||  
 |  ||    |  ||   |           |         |||  |    |     |||   ||       |         |  /-++-++------+-----++--+---++--------++--++---\    |||    |   ||  
 |  ||    |  ||   |           |         |||  |    |    /+++---++-------+---------+--+-++-++------+-----++-\|   ||        ||  ||   |    |||    |   ||  
 |  ||    |  ||   |           |         |||  |    | /--++++---++-------+---\     |  | || ||      |     || ||   ||  /-----++--++---+\   |||    |   ||  
 |  ||    |  ||   |           |/--------+++--+----+-+--++++---++-------+---+-----+--+-++-++------+-----++-++---++--+-----++--++-\ ||   |||    |   ||  
 |  ||    |  ||   |           ||        |||  | /--+-+--++++---++-------+---+-----+--+-++-++------+-----++-++---++--+--\  ||  || | ||   |||    |   ||  
 |  ||    |  ||   |           ||        |||  |/+--+-+--++++---++-------+---+-----+--+\|| ||      |     || ||   ||  |  |  ||  || | ||   |||    |   ||  
 |  ||    |  ||   | /---------++--------+++--+++--+-+--++++---++-------+---+-----+--++++-++--\   |     || ||   ||  |  |  ||  || | ||   |||    |   ||  
 |  ||    |  ||   | |       /-++--------+++--+++--+-+--++++\  ||       |   |     |  |||| ||  |   |     || ||   ||  |  |  ||  || | ||   |||    |   ||  
 |  ||    \--++---+-+-------+-++--------+++--+++--+-+--+/\++--++-------+---+-----+--+++/ ||  |   |     || ||   ||  |  |  ||  || | ||   |||    |   ||  
 |  ||       ||  /+-+-------+-++--------+++--+++--+-+--+--++--++-------+---+-----+--+++--++--+---+-----++-++---++--+-\|  ||  || | ||   |||    |   ||  
 |  ||       ||  || |       | ||        |||  |||  | |  |  ||  ||       |   |     | /+++--++--+---+-----++-++---++--+-++--++\ || | ||   |||    |   ||  
 |  ||       ||  || |       | ||        |||  |||  | |  |  ||  ||       \---+-----+-++++--++--+---+-----/| ||   ||  | ||  ||| || | ||   |||    |   ||  
 |  ||       ||  || |       | ||      /-+++--+++--+-+--+--++--++-----------+-----+-++++--++--+---+------+-++---++--+\||  ||| || | ||   |||    |   ||  
 |  ||      /++--++-+-------+-++------+-+++-\|||/-+-+--+--++--++-----------+-----+-++++--++--+---+------+-++---++-\\+++--+++-++-+-+/   |||    |   ||  
 |  ||      |||  || |       | ||      | \++-+++++-+-+--+--++--++-----------+-----+-++++--+/  |   | /----+-++---++-+-+++--+++\|| | |    |||    |   ||  
 |  ||      |||  ||/+-------+-++------+--++-+++++-+-+--+--++--++-----------+-----+-++++--+---+-\ | |    | |v   || | |||  |||||| | |    |||    |   ||  
 |  ||      |||  ||||       | ^|      |  || ||||| | |  |  ||  ||      /----+-----+-++++--+---+<+-+-+----+-++---++\| |||  |||||| | |    |||    |   ||  
 \--++------+/|  ||||       | ||  /---+--++-+++++-+-+--+--++--++------+----+-----+-++++--+---+-+-+-+-\  | || /-++++-+++--++++++\| |    |||    |   ||  
    ||      | |  ||||       | ||  |   |  ||/+++++-+-+--+--++--++------+----+-----+-++++--+---+-+-+-+-+--+-++-+-++++-+++--++++++++-+----+++\   |   ||  
    ||      | |  ||||     /-+-++--+---+--++++++++-+-+--+--++--++------+----+-----+-++++--+---+-+-+-+-+--+-++-+-++++-+++\ |||||||| |    ||||   |   ||  
    ||      | |  ||||     | | ||  |   |  |||||||| | |  |  ||  ||   /--+----+-----+-++++--+---+-+-+-+-+--+-++-+-++++-++++-++++++++\|    ||||   |   ||  
    ||      | |  ||||     | \-++--+---+--++++++++-+-+--+--+/  || /-+--+----+-----+-++++--+---+-+-+-+-+--+-++-+-++++-++++-++++++++++----++++---+\  ||  
    ||      | |  ||||     |   ||  |   |  |||||||| | |  |/-+---++-+-+--+----+-----+-++++--+---+-+<+-+-+--+-++-+-++++-++++\||||||||||    ||||   ||  ||  
    ||     /+-+--++++-\   |   ||  |   |  |||||||| | |  || |   ||/+-+--+----+--\  | ||||  |   | | | | |  | || | |||| |||||||||||||||    ||||   ||  ||  
    ||/----++-+--++++-+---+---++--+---+--++++++++-+-+--++-+---++++-+--+----+--+--+-++++\ |   | | | | |  | || | |||| |||||||||||||||    ||||   ||  ||  
  /-+++----++-+--++++-+---+---++--+-\ |  |||||||| | |  || |   |||| |  |    |  |  | ||||| |  /+-+-+-+-+--+-++-+-++++-+++++++++++++++----++++---++--++-\
  | |||    || |  |||| |   |   ||  | | | /++++++++-+-+--++-+---++++-+--+----+--+--+-+++++-+--++-+-+-+-+--+-++-+\|||| |||||||||||||||    ||||   ||  || |
  | |||    || |  |||| |   |   ||  | | | ||||||||| | |  || | /-++++-+--+----+--+--+-+++++-+--++-+-+-+-+--+-++-++++++-+++++++++++++++----++++-\ ||  || |
  | |||    || |  |||| |   |   ||  | | | ||||||||| | |  || | | |||| |  |    |  |  | ||||| |  || | | | |  | || |||||| |||||||||||||||    |||| | ||  || |
  |/+++----++\|  |||| |   |   ||  | | | ||||||||| | | /++-+-+-++++-+--+----+--+--+\||||| |  || | | | |  | || |||||| |||||||||||||||    |||| | ||  || |
  |||||    ||||  |||| |   |   || /+-+-+-+++++++++\| | ||| | | |||| |  |    |  |  ||||||| |  || | | | |  | || |||||| |||||||||||||||    ||\+-+-++--+/ |
  |||||    ||||  |||| |   |   || ^| | | ||||||||||| | ||| | | |||| |  |    |  |  ||||||| |  || | | | |  | || |||||| |||||||||||||||    || | | ||  |  |
  |||||    ||||  |||| |   |   || || | | ||||||||||| | ||| | | |\++-+--+----+--+--+++++++-+--++-+-+-+-+--/ || |||||| |||||||||||||||/---++-+-+-++\ |  |
  |||||    ||||  |||| |   |   || || | | ||||||||||| | ||| | | | || |  |    |  |  ||||||| |  || | | | |    || |||||| ||||||||||||||||   || | | ||| |  |
  |||||    ||||/-++++-+---+---++-++-+-+-+++++++++++-+-+++-+-+-+-++-+--+---\|  |  ||||||| |  || | | | |    || |||||| ||||||||||||||||   || | | ||| |  |
  |||||    ||||| |||| |   |   || || | | |\+++++++++-+-+++-+-+-+-++-+--+---++--+--+++++++-+--++-+-/ \-+----++-++++++-++++++++/|||||||   || | | ||| |  |
  |||||    ||||| |||| |   |   || ||/+-+-+-+++++++++-+-+++-+-+-+-++-+--+---++--+--+++++++-+--++-+-----+----++\|||\++-++++++++-+++++++---+/ | | ||| |  |
  |||||    ||||| |||| |/--+---++-++++-+-+-+++++++++-+-+++-+-+-+-++-+--+---++--+--+++++++-+--++-+--\  |    |||||| || |||||||| |||||||   |  | | ||| |  |
  |\+++----++/|| |||| ||  |   || |||| | | ||||||||| | ||| | |/+-++-+--+---++-\|  ||||||| |  || |  | /+----++++++-++-++++++++-+++++++---+--+-+\||| |  |
 /+-+++----++-++-++++-++--+---++-++++-+-+-+++++++++-+-+++-+-+++-++-+--+---++-++--+++++++-+--++-+--+-++--\ |||||| || |||||||| |||||||   |  | ||||| |  |
 || |||    \+-++-++++-/|  |   || |||| | | ||||||||| |/+++-+-+++-++-+--+---++-++--+++++++-+--++-+--+-++--+-++++++-++-++++++++-+++++++---+--+-+++++-+-\|
 || |||     | ||/++++--+--+---++-++++-+-+-+++++++++-+++++-+-+++-++-+--+---++-++--+++++++-+--++-+--+-++--+-++++++\|| |||||||| |||||||   |  | ||||| | ||
 || |||     | ||||\++--+--+---/| |||| | | ||||||||| ||||| | ||| || |  |   || ||  |||\+++-+--++-+--+-++--+-+++++++++-++++++++-+++++/|   ^  | ||||| | ||
 || |||     | |||| ||  |  |/---+-++++-+-+-+++++++++-+++++-+-+++-++-+--+---++-++\ ||| ||| |  || |  | ||  | ||||||||| |||||||| ||||| |   |  | ||||| | ||
 || |\+-----+-++++-++--+--++---+-++++-+-+-+++++++++-+++++-+-++/ || |  |   || |||/+++-+++-+--++-+--+-++--+-+++++++++-++++++++-+++++-+-\ |  | ||||| | ||
 || | |/----+-++++-++--+--++---+-++++-+-+-+++++++++-+++++-+-++--++-+-\|   || ||||||| ||| |  || |  | ||  | ||||||||| |||||||| ||||| | | |  | ||||| | ||
 || | || /--+-++++-++--+-\||   | |||| | | ||||||||| ||||| | ||  || | ||   || ||||||| ||| |  || |  | ||  | |\+++++++-++++++++-/|||| | | |  | ||||| | ||
 ||/+-++-+--+-++++-++--+-+++--\| |||| | | ||||||\++-+++++-+-++--++-+-++---++-+++++++-+++-+--++-+--+-++--+-+-++++++/ ||||||||  |||| | | |  | ||||| | ||
 |||| || |  | |||| ||  | |||  || \+++-+-+-++++++-/| ||||| | \+--++-+-++---++-+++++++-+++-+--++-+--+-++--+-+-++++++--++++++++--++++-+-+-+--+-/|||| | ||
 |||| || |/-+-++++-++--+-+++--++--+++-+-+-++++++--+-+++++-+--+--++-+-++---++-+++++++-+++-+--++-+--+-++-\| | |||||| /++++++++--++++-+-+-+-\|  |||| | ||
 |||| || || | |||| ||  | |||  ||/-+++-+-+-++++++--+-+++++-+--+--++-+-++---++-+++++++-+++\| /++-+--+-++\|| | |\++++-+++++++++--+/|| | | | ||  |||| | ||
 |||| || || | |||| ||  | |||  ||| ||| | | ||||||  | ||||| |  |  || | ||   || ||||||| ||||| ||| |  | ||||| | | |||| |||||||||  | || | | | ||  |||| | ||
 |||| || || | |||| ||  | ||\--+++-+++-+-+-++++++--+-+++++-+--+--++-+-++---++-++/|||| ||||| ||| |  | |||||/+-+-++++-+++++++++--+-++-+-+-+-++--++++\| ||
 |||| || || | |||| || /+-++---+++\||| | | ||||||  | ||||| |  |  || | ||   || || |||| ||||| ||| |  | \++++++-+-++++-+++++++++--+-++-+-+-+-++--/||||| ||
 |||| || || | |||| || || ||   ||||||| | | ||||||  | ||||| |  |  || | ||   || || |||| ||||| ||| |  |  |||||| | |||| |||||||||  | || \-+-+-++---++/|| ||
 |||| || || | |||| || || ||   ||||||| | | ||||||  | ||||| |  |  || | |^   || || |||| ||||| ||| |  |  |||||| | |||| |||||||||  | ||   | | ||   || || ||
 |||| || || | |||| || || ||   ||||||| | | ||||||  | ||||| \--+--++-+-++---++-++-++++-+++++-+++-+--+--++++++-+-++++-+++++++++--/ ||   | | ||   || || ||
 |||| || || | |||| || || ||   ||||||| | | ||||||  | |||||    |  || | ||   || || |||| ||||| ||| |  |  |||||| | |||| |||||||||    ||   | | ||   || || ||
 |||| || || | |||| || || ||   ||||||| \-+-++++++--+-+++++----+--++-+-++---++-++-++++-+++++-+++-+--+--++++++-+-++++-+/|||||||    ||   | | ||   || || ||
/++++-++-++-+-++++-++-++-++\  |\+++++---+-++++++--+-+++++----+--++-+-++---++-++-++++-+++++-+++-+--+--++++++-+-++++-+-+++++++----/|   | | ||   || || ||
||||| || || | |||| || || |||  | |||||   | ||||||  | |||||    |  ||/+-++---++-++-++++<+++++-+++-+--+--++++++-+-++++-+-+++++++-----+--\| | ||   || || ||
||||| || || |/++++-++-++-+++--+-+++++---+-++++++--+-+++++----+--++++-++---++-++\|||| ||||| ||| |  |  |||||| | |||| | |||||||     |  || | ||   || || ||
||\++-++-++-++++++-++-++-+++--+-++++/   | ||||||  | |||||    |  |||| ||   || ||||||| ||||| ||| |  |  |||||| | |||| | |||||||     |  || | ||   || || ||
|| || || || |||||| || || |||  | ||||    | ||||||  | ||\++----+--++++-++---++-+++++/| ||||| ||| |  |  |||||| | |||| | |||||\+-----+--++-/ ||   || || ||
|| || || || ||\+++-++-++-+++--+-++++----+-++++++--/ || ||    |  |||| ||   || ||||| | |||||/+++-+--+--++++++-+-++++-+-+++++-+--\  |  ||   ||   || || ||
|| || || || || ||| || || |||  | ||||    | |||\++----++-++----+--++++-++---++-+++++-+-+++++++++-+--+--++++++-+-++++-+-+++++-+--+--+--++---++---/^ || ||
|| || || || || ||| || || |||  | ||||    | ||| ||    || ||    |  |||| ||   || ||||| | ||||||||| |  | /++++++-+-++++-+-+++++-+--+--+--++---++----+-++\||
|| || || || || ||| || || |||/-+-++++----+\||| ||    || ||    |  |||| ||   || ||||| | ||||||||| |  | ||||||| | |||| | ||||| |  |  |  ||   ||    | |||||
|| || || || || |||/++-++-++++\| ||||    ||||| ||    || ||    |  |||| ||   || ||||| | ||||||||| |  | ||||||| |/++++-+-+++++-+\ |  |  ||   ||    | |||||
|| || |\-++-++-++++++-++-++++++-++++----+++++-++----++-++----+--++++-/|   || ||||| | ||||||||| |  | ||||||| |||||| | ||||| || |  |  ||   ||    | |||||
|| || |  || || ||||\+-++-++++++-++++----+++++-++----++-++----+--++++--+---++-+++++-+-+++++++++-/  | ||||||| |||||| | ||||| || |  |  ||   ||    | |||||
|| || |  || || |||| | || |||||| ||||    ||||| ||    || ||    |  ||||  |   || ||||| | |||||||||    | ||||||| |||||| | ||||| || |  |  ||   ||    | |||||
|| || |  || || |||| | || |||||| ||||    ||||| ||    || ||    |  ||||  |   || ||||| | |||||||||    | ||||||| |||||| | ||||| || |  |  ||   ||    | |||||
|| ||/+--++-++-++++-+-++-++++++-++++----+++++-++----++-++----+--++++--+---++-+++++-+-+++++++++--\ | ||||||| |||||| | ||||| || |  |  ||   ||    | |||||
|| ||||  || || |||| | || |||||| ||||    |||||/++----++-++----+--++++--+-\ || ||||| | |||||||||  | | ||||||| |||||| | ||||| || |  |  ||   ||    | |||||
|| ||||  || || |||| | || |\++++-++++----++++++++----++-++----+--++++--+-+-++-+++++-+-+++++++++--+-+-+++++++-++++++-+-++/|| || |  |  ||   ||    | |||||
|| ||||  || || |||| | || | |||| ||||    ||||||||    || ||   /+--++++--+-+-++-+++++-+-+++++++++\ | | ||||||| |||||| | || || || |  |  ||   ||    | |||||
|| ||||  || || |||| | || | |||| |||\----++++++++----++-++---++--++++--+-+-++-+++++-+-++++++++++-+-+-+++++++-/\++++-+-++-++-+/ |  |  ||   ||    | |||||
|| ||||  || || |||| \-++-+-++++-+++-----++++++++----++-++---++--++++--+-+-++-+++++-+-++++++++/| | | |||||||   |||| | || || |  |  |  ||   ||    | |||||
|| ||||  || || ||||   \+-+-++++-+/|     |||||||\----++-++---++--++++--+-+-++-+++++-+-++++++++-+-+-+-+++++++---++++-+-+/ || |  |  |  ||   ||    | |||||
|| ||||  || || ||||    | | |||| \-+-----+++++++-----++-++---++--++++--+-+-++-+++++-+-+++/|||| | | | |||||||   |||| | |  || |  |  |  ||   ||    | |||||
|| ||||  || || ||||/---+-+-++++---+-----+++++++----\|| ||   ||  ||||  | | || ||||| | ||| |||| | | | |||||||   |||| | |  || |  |  |  ||   ||    | |||||
|| ||||  || || |||||   | | ||||/--+-----+++++++----+++-++---++--++++--+-+-++\||||| | ||| |||| | | | |||||||   |||| | |  || |  |  |  ||   ||    | |||||
|| ||||  || || |||||   | | |||||  |     |||||||    ||| |\---++--++++--+-+-++++++++-+-+++-++++-+-+-+-+++++++---++++-+-+--/| |  |  |  ||   ||    | |||||
|| ||||  || || |||||   | | |\+++--+-----+/|||||    ||| |    ||  ||||  | | |||||||| \-+++-++++-+-+-+-+++++++---++++-+-+---+-/  |  |  ||   ||    | |||||
|| ||||  || || |||||   | | | |||  |     | |||||    ||| |    ||  ||||  | | ||||||||   ||| |||| | | | \++++++---++++-+-+---+----+--+--++---++----+-++/||
|| |\++--++-++-+++++---+-+-+-+++--+-----+-+++++----+++-+----++--++++--+-+-+++++++/   ||| |\++-+-+-+--++++++---++++-+-+---+----/  |  ||   ||    | || ||
|| |/++--++-++-+++++---+-+\| |||  |     | |||||    ||| |    \+--++++--+-+-+++++++----+++-+-++-/ | |  |||||| /-++++-+-+---+-------+--++---++-\  | || ||
|| ||||  || || |||||   | ||| |||  |     | \++++----+++-+-----+--++++--+-+-+++++++----+++-/ ||   |/+--++++++-+-++++-+-+---+-------+--++---++-+--+-++\||
|| ||||  || || |||||   | ||| |||  |     |  ||||    ||| |     |  ||||  | | |||||||    |\+---++---+++--++++++-+-++++-+-+---+-------+--++---++-+--+-+/|||
|| ||||  || || |||||   | ||| |||  |    /+--++++----+++-+-----+--++++--+-+-+++++++----+-+---++---+++--++++++-+-++++-+-+---+---\   |  ||   || |  | | |||
|| ||||  || || |||||   | |||/+++--+----++--++++----+++-+-----+--++++--+-+\|||||||    | |   ||   |||/-++++++-+-++++-+-+---+---+---+--++\  || |  | | |||
|| ||||  || || |||||   | |||||||  |    ||  ||\+----+++-+-----+--++++--+-/||||||||    | |   ||   |||| |||||| | |||| | |   |   |   | /+++--++-+-\| | |||
|| ||||  || \+-+++++---+-+++++++--+----++--+/ |    ||| |     |  |||\--+--++++++++----+-+---++---++++-++++++-+-++++-+-+---+---+---/ ||||  || | || | |||
|| ||||  ||  | |||||   | ||||||\--+----++--+--+----+++-+-----+--+++---+--+++/||||    | |   ||   |||| |||||| | |\++-+-+---/   |     ||||  || | || | |||
|| ||||  ||  | |||||   | ||||||   |    ||  |  |    |\+-+-----+--+++---+--++/ ||||    |/+---++---++++-++++++\| | || | |       |     ||||  || | || | |||
|| ||||  ||  | |||||   | ||||||   |    |\--+--+----+-+-+-----+--+++---+--++--++++----+++---++---++++-++++++++-/ || | |       |     ||||  || | || | |||
|| ||||  ||  | |||||   | ||||||   |    |   |  |    | | |     |  |||   |  ||  ||||    |||   |\---++++-++++++++---++-+-+-------+-----++++--++-+-++-+-++/
|| ||||  ||  | |||||   | ||||||   |    |   |  |    | | |     |  |||   |  ||  ||||    |||   |    |\++-++++++++---++-+-+-------+-----++++--++-+-++-+-/| 
|| ||||  \+--+-+++++---+-/|||||   |    |   |  |    | | |     |  \++---+--++--+/||    |||   |    | || ||||||||   || | |       |     ||||  || | || |  | 
|| ||||   |  | |||||   |  |||||   |    |   |  |    | | |     |   ||   |  ||  | ||    |||   |    | || ||||||||   || | |       |     ||||  || | || |  | 
|| ||||   |  | |||||   |  |||||   |    |   |  |    | | \-----+---++---+--++--+-++----+++---+----+-++-+++++/||   || | |       |     ||||  || | || |  | 
|| ||||   |  | |||||   |  |||||   |    |   \--+----+-+-------+---++---+--++--+-++----+++---+----+-++-+++++-++---++-+-+-------+-----++++--+/ | |^ |  | 
|| ||||   |  | |||||   |  |||||   |    |      |    | |       |   ||   |  ||  | ||    |||   |    | || ||||| ||   || | |       |     ||||  |  | || |  | 
|| ||||   |  | |||||   |  |||||   |    |      |    | |       |   ||   |  ||  | ||  /-+++---+----+-++-+++++-++---++-+\|       |     ||||  |  | || |  | 
|| ||||   |  | |||||   |  |||||   \----+------+----+-+-------+---++---+--++--+-++--+-+++---+----+-++-/|||| ||   || |||       |     ||||  |  | || |  | 
\+-++++---+--+-+++++---+--+/|||        |      |    | |       |   || /-+--++--+-++--+-+++---+----+-++--++++-++---++-+++-------+----\||||  |  | || |  | 
 | ||||   |  | |||||   |  | |||        |      \----+-+-------+---++-+-+--++--+-++--+-/||   |    | ||  |||| ||   || ||| /-----+----+++++--+--+\|| |  | 
 | ||||   |  | |||||  /+--+-+++--------+-----------+-+-\     |   || | |  ||  | |\--+--++---+----+-++--++++-++---++-+++-+-----+----+++/|  |  |||| |  | 
 | ||||   |  | |||||  ||  | |||        |           | | |     |   |\-+-+--++--+-+---+--++---+----+-++--++++-++---++-+++-+-----+----++/ |  |  |||| |  | 
 | ||||   |  | ||\++--++--+-+++--------+-----------+-+-+-----+---+--+-+--++--+-+---+--++---+----+-++--++++-++---++-++/ |     |    ||  |  |  |||| |  | 
 | |||\---+--+-++-++--++--+-+++--------+-----------+-+-+-----+---+--+-+--++--+-+---+--+/   |    | ||  |||| ||   || ||  |     |    ||  |  |  |||| |  | 
 | |||    |  | || \+--++--+-+/|        |           | | |     |   |  | |  ||  | |   |  |    |    | ||  |||| |\---++-++--+-----+----++--+--+--/||| |  | 
 | |||    |  |/++--+--++--+-+-+--------+-----------+-+-+-----+---+--+-+--++--+-+---+--+----+----+-++--++++\|    || ||  |     |    ||  |  |   ||| |  | 
 | |||    |  ||||  |  ||  | \-+--------+-----------+-+-+-----+---+--+-+--/|  | |   |  |    |    | ||  ||||||    || ||  |     |    ||  |  |   ||| |  | 
 | |||    \--++++--+--++--+---+--------+-----------+-+-+-----+---+--+-+---+--+-+---+--+----+----+-++--+/||||    || ||  |     |    ||  |  |   ||| |  | 
 | |||       ||||  |  ||  |   |        |           | | |     |   |  | |   |  | |   |  |    |    | ||  | ||||    || ||  |     |   /++--+--+---+++-+-\| 
 | |||       ||||  |  ||  |   |        |           ^ | |     |   |  | |   |  | |   |  |    |    | ||  | ||||    || ||  |     |   |||  |  |   ||| | || 
 \-+++-------++++--+--++--+---+--------+-----------+-+-+-----+---+--+-+---+--+-+---+--+----+----+-++--+-/|||    || ||  |     |   ||\--+--+---+/| | || 
   |||       ||||  |  ||  |   |        |           | | |     \---+--+-+---+--/ |   |  \----+----+-++--+--++/    || ||  |     |   ||   |  |   | | | || 
   |||       ||\+--+--++--+---+--------+-----------+-+-+---------+--+-+---/    |   |       |    | ||  |  ||     |v ||  |     |   ||   |  |   | | | || 
   |||       || |  |  \+--+---+--------+-----------+-+-/         |  | \--------+---+-------+----+-++--+--++-----+/ ||  |     |   ||   |  |   | | | || 
   |||       || |  |   |  |   |        |           | |           |  |          |   |       |    | ||  |  ||     |  ||  |     |   ||   |  |   | | | || 
   ||\-------++-+--+---+--+---+--------+-----------+-+-----------+--+----------+---+-------+----/ ||  |  ||     |  ||  |     |   ||   |  |   | | | || 
   ||        || |  |   |  |   |        |           | |           |  \----------+---+-------+------++--+--++-----+--++--+-----+---+/   |  |   | | | || 
   \+--------++-+--+---+--+---/        \-----------+-+-----------+-------------+---+-------+------++--+--++-----+--++--+-----/   |    |  |   | | | || 
    |        || |  |   |  |                        | |           \-------------+---+----<--+------++--+--++-----+--++--+---------+----+--+---+-/ | || 
    |        \+-+--+---+--+------------------------+-+-------------------------/   \-------+------++--+--++-----+--+/  |         |    |  |   |   | || 
    |         \-+--+---+--+------------------------+-+-------------------------------------+------++--+--+/     |  |   |         |    |  |   |   | || 
    |           \--+---+--+------------------------+-+-------------------------------------+------++--+--+------/  |   |         \----+--+---+---+-/| 
    |              |   |  |                        | |                                     \------++--/  |         \---+--------------+--/   |   |  | 
    \--------------+---+--/                        | |                                            ||     |             |              |      |   |  | 
                   |   |                           | \--------------------------------------------++-----+-------------+--------------+------+---+--/ 
                   |   |                           |                                              ||     |             \--------------+------/   |    
                   \---+---------------------------/                                              |\-----+----------------------------/          |    
                       \--------------------------------------------------------------------------/      \---------------------------------------/
""", (49, 83))
]

directions = {
    '^': (-1, 0),
    'v': (1, 0),
    '<': (0, -1),
    '>': (0, 1)
}


def advance(pos, direction):
    return pos[0] + directions[direction][0], pos[1] + directions[direction][1]


# left, straight, right
LEFT = 0
STRAIGHT = 1
RIGHT = 2

BACKSLASH = '\\'

turn_left = {
    '^': '<',
    'v': '>',
    '<': 'v',
    '>': '^',
}

turn_right = dict(zip(turn_left.values(), turn_left.keys()))

assert all(turn_left[turn_right[d]] == d for d in directions)


def turn(current_dir, corner, cart_next_turn):
    if corner == '+':
        if cart_next_turn == LEFT:
            return turn_left[current_dir], (cart_next_turn + 1) % 3
        elif cart_next_turn == STRAIGHT:
            return current_dir, (cart_next_turn + 1) % 3
        else:
            return turn_right[current_dir], (cart_next_turn + 1) % 3
    elif corner == BACKSLASH:
        if current_dir in '^v':
            return turn_left[current_dir], cart_next_turn
        else:
            assert current_dir in '<>'
            return turn_right[current_dir], cart_next_turn
    else:
        assert corner == '/', "wrong corner %s" % (corner,)
        if current_dir in '^v':
            return turn_right[current_dir], cart_next_turn
        else:
            assert current_dir in '<>'
            return turn_left[current_dir], cart_next_turn


assert turn('>', BACKSLASH, LEFT) == ('v', LEFT)
assert turn('<', '/', LEFT) == ('v', LEFT)
assert turn('^', '/', LEFT) == ('>', LEFT)
assert turn('v', BACKSLASH, LEFT) == ('>', LEFT)
assert turn('v', '+', LEFT) == ('>', STRAIGHT)
assert turn('v', '+', STRAIGHT) == ('v', RIGHT)
assert turn('v', '+', RIGHT) == ('<', LEFT)


def solve(input):
    corners = {}
    carts = []
    for y, line in enumerate(input.split('\n')):
        for x, c in enumerate(line):
            if c in r'\+/':
                corners[(y, x)] = c
            elif c in 'v^<>':
                carts.append(((y, x), c, LEFT))

    t = 0
    while True:
        carts = sorted(carts)
        # print(t, ','.join(str(pos) for pos in carts))
        for i, (cart_pos, cart_direction, cart_next_turn) in enumerate(carts):
            next_cart_pos = advance(cart_pos, cart_direction)
            if next_cart_pos in [cart[0] for cart in carts]:
                return next_cart_pos
            if next_cart_pos in corners:
                next_cart_direction, next_cart_next_turn = turn(cart_direction, corners[next_cart_pos], cart_next_turn)
            else:
                next_cart_direction = cart_direction
                next_cart_next_turn = cart_next_turn
            carts[i] = (next_cart_pos, next_cart_direction, next_cart_next_turn)
        # print(t, len(carts))
        t += 1


if __name__ == '__main__':
    for case in TEST_CASES:
        result = solve(case.case)
        check_case(case, result)

    y, x = solve(INPUT)
    assert (x, y) == (45, 34)
    print("%d,%d" % (x, y))
